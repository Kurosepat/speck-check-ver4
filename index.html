<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æ˜ç´°æ›¸AIãƒã‚§ãƒƒã‚¯</title>
  <script src="uploadscript.js" defer></script>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      background: linear-gradient(to right, #bbb, #333);
      color: white;
      padding: 2rem;
    }
    form {
      background: #222;
      padding: 2rem;
      border-radius: 8px;
      display: inline-block;
      width: 90%;
      max-width: 600px;
    }
    label {
      font-weight: bold;
      margin-top: 1rem;
      display: block;
      text-align: left;
    }
    input[type="text"] {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.5rem;
      border-radius: 5px;
      border: none;
    }
    button {
      background-color: #2196f3;
      color: white;
      font-weight: bold;
      cursor: pointer;
      padding: 0.75rem;
      width: 100%;
      border: none;
      border-radius: 5px;
      margin-top: 2rem;
    }
    .drop-zone {
      border: 2px dashed #ccc;
      border-radius: 8px;
      padding: 1.5rem;
      margin-top: 1rem;
      background-color: #333;
      cursor: pointer;
      position: relative;
    }
    .drop-zone input[type="file"] {
      display: none;
    }
    .file-display {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1rem;
      margin-top: 0.5rem;
    }
    .file-label {
      font-weight: bold;
    }
    .remove-btn {
      color: red;
      cursor: pointer;
      font-size: 1.5rem;
    }
    .notice {
      font-size: 0.9rem;
      margin-top: 0.5rem;
      color: #ddd;
      text-align: left;
    }
    #result {
      white-space: pre-wrap;
      margin-top: 30px;
      background: white;
      color: black;
      padding: 1rem;
      border-radius: 8px;
      text-align: left;
    }
    #result:empty::before {
      content: "ï¼ˆã“ã“ã«ãƒã‚§ãƒƒã‚¯çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼‰";
      color: #888;
      font-size: 0.85rem;
    }

    .loading-dots::after {
      content: '';
      display: inline-block;
      animation: dotloop 2s steps(10, end) infinite;
      white-space: nowrap;
      overflow: hidden;
      vertical-align: bottom;
      font-weight: bold;
    }

    @keyframes dotloop {
      0% { content: ''; }
      10% { content: '.'; }
      20% { content: '..'; }
      30% { content: '...'; }
      40% { content: '....'; }
      50% { content: '.....'; }
      60% { content: '......'; }
      70% { content: '.......'; }
      80% { content: '........'; }
      90% { content: '.........'; }
      100% { content: '..........'; }
    }
  </style>
</head>
<body>
  <h1>æ˜ç´°æ›¸ãƒ»ç‰¹è¨±è«‹æ±‚ã®ç¯„å›²ãƒ»è¦ç´„æ›¸AIãƒã‚§ãƒƒã‚¯</h1>
  <form id="uploadForm" enctype="multipart/form-data">
    <label for="shoin_id">æ‰€å“¡IDã¾ãŸã¯æ°åï¼ˆå¿…é ˆï¼‰</label>
    <input type="text" name="shoin_id" id="shoin_id" required />

    <label for="today-date">æ—¥ä»˜ï¼ˆè‡ªå‹•ï¼‰</label>
    <input type="text" name="date" id="today-date" readonly />

    <label for="seiri_no">æ•´ç†ç•ªå·ï¼ˆå¿…é ˆï¼‰</label>
    <input type="text" name="seiri_no" id="seiri_no" required />

    <label for="meisaisho_file">æ˜ç´°æ›¸ï¼ˆå¿…é ˆï¼‰</label>
    <div class="drop-zone" id="docxZone">
      <span class="placeholder">æ˜ç´°æ›¸ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.docxï¼‰ã‚’<br>ã“ã“ã«ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ— ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ</span>
      <input type="file" name="meisaisho" id="meisaisho_file" accept=".docx" required />
      <div class="file-display" id="docx-display" style="display: none;">
        <span class="file-label" id="docx-name"></span>
        <span class="remove-btn" id="remove-docx">ğŸ—‘</span>
      </div>
    </div>
    <div class="notice">æ˜ç´°æ›¸ã¯ .docx å½¢å¼ã§ã”æå‡ºãã ã•ã„ã€‚</div>

    <label for="zumen_file">å›³é¢ï¼ˆä»»æ„ï¼‰</label>
    <div class="drop-zone" id="pdfZone">
      <span class="placeholder">å›³é¢ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆPDF, ä»»æ„ï¼‰ã‚’<br>ã“ã“ã«ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ— ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ</span>
      <input type="file" name="zumen" id="zumen_file" accept=".pdf" />
      <div class="file-display" id="pdf-display" style="display: none;">
        <span class="file-label" id="pdf-name"></span>
        <span class="remove-btn" id="remove-pdf">ğŸ—‘</span>
      </div>
    </div>
    <div class="notice">
      å›³é¢ã¯ PDF å½¢å¼ï¼ˆOCRåŒ–æ¨å¥¨ï¼‰ã‚’ã”æå‡ºãã ã•ã„ã€‚ç‰¹ã«ã€ãƒ–ãƒ­ãƒƒã‚¯å›³ã‚„ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆç­‰ã®æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€OCRåŒ–ã—ãŸã‚‚ã®ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚
    </div>

    <button type="submit">AIãƒã‚§ãƒƒã‚¯ã‚’é–‹å§‹</button>
  </form>

  <script>
    document.getElementById("today-date").value = new Date().toISOString().split('T')[0];

    function setupDropZone(zoneId, inputId, nameId, removeId, displayId) {
      const zone = document.getElementById(zoneId);
      const input = document.getElementById(inputId);
      const name = document.getElementById(nameId);
      const remove = document.getElementById(removeId);
      const display = document.getElementById(displayId);
      const placeholder = zone.querySelector('.placeholder');

      function updateDisplay() {
        if (input.files.length > 0) {
          name.textContent = input.files[0].name;
          display.style.display = 'flex';
          placeholder.style.display = 'none';
        } else {
          display.style.display = 'none';
          placeholder.style.display = 'block';
        }
      }

      zone.addEventListener('click', () => input.click());

      zone.addEventListener('dragover', (e) => {
        e.preventDefault();
        zone.style.backgroundColor = '#444';
      });

      zone.addEventListener('dragleave', () => {
        zone.style.backgroundColor = '#333';
      });

      zone.addEventListener('drop', (e) => {
        e.preventDefault();
        zone.style.backgroundColor = '#333';
        const files = e.dataTransfer.files;
        if (files.length > 0) {
          const dt = new DataTransfer();
          dt.items.add(files[0]);
          input.files = dt.files;
        }
        updateDisplay();
      });

      input.addEventListener('change', updateDisplay);
      remove.addEventListener('click', () => {
        input.value = '';
        updateDisplay();
      });
    }

    setupDropZone('docxZone', 'meisaisho_file', 'docx-name', 'remove-docx', 'docx-display');
    setupDropZone('pdfZone', 'zumen_file', 'pdf-name', 'remove-pdf', 'pdf-display');
  </script>
</body>
</html>
